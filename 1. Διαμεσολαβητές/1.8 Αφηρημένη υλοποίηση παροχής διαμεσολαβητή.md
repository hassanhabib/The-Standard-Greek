# 1.8 Πρότυπες Βιβλιοθήκες Παροχής Υπηρεσιών (SPAL)
Αυτό το ειδικό κεφάλαιο θα συζητήσει τους πάροχους στους οποίους μπορεί να βασίζονται οι μεσίτες για την εκτέλεση μιας συγκεκριμένης λειτουργίας. Οι περισσότεροι μεσίτες βασίζονται σε εξωτερικές βιβλιοθήκες ή διαδικασίες που δεν ανήκουν στους μηχανικούς που αναπτύσσουν το σύστημα. Αυτές οι εξωτερικές βιβλιοθήκες μπορεί να ακολουθούν ή όχι τις βέλτιστες πρακτικές σε όρους αφαίρεσης και δοκιμών.

Το Πρότυπο απαιτεί την εξάρτηση από προτυποποιημένους παρόχους για τον σχεδιασμό και την ανάπτυξη συστημάτων. Αυτοί οι προτυποποιημένοι πάροχοι πρέπει να έχουν τα ακόλουθα χαρακτηριστικά:

## 1.8.0 Επεκτασιμότητα
Οι προτυποποιημένες βιβλιοθήκες αφαίρεσης παρόχων πρέπει να είναι επεκτάσιμες για να υποστηρίξουν περισσότερους εξωτερικούς παρόχους. Για παράδειγμα, μια βιβλιοθήκη που υποστηρίζει την επικοινωνία με μια βάση δεδομένων SQL Server πρέπει να είναι επεκτάσιμη αρκετά ώστε να υποστηρίζει την επικοινωνία με τη MongoDB ή τη MariaDb ή οποιουδήποτε άλλου πάροχου χωρίς καμία επιπλέον επιβάρυνση για τον χρήστη αυτών των βιβλιοθηκών.

<div align=center>
    <img src="https://raw.githubusercontent.com/hassanhabib/The-Standard/master/1.%20Brokers/Resources/Brokers-1.8.0.png" />
</div>

### 1.8.0.0 Δυνατότητα Διαμόρφωσης
Για να είναι δυνατή η χρήση των προτυποποιημένων βιβλιοθηκών με πολλούς παρόχους, πρέπει να επιτρέπουν στους μηχανικούς να τις διαμορφώνουν για να στοχεύουν σε έναν συγκεκριμένο πάροχο τοπικά ή απομακρυσμένα. Για παράδειγμα, οι βιβλιοθήκες αφαίρεσης παρόχων μπορούν να διαμορφωθούν με τον ακόλουθο τρόπο:

```csharp
public class StorageBroker
{
    private readonly IProviderAbstraction providerAbstraction;

    public StorageBroker()
    {
        this.providerAbstraction = new ProviderAbstraction();
        
        this.providerAbstraction.Configure(provider => 
            provider.UseSqlServer(connectionString: ....));
    }
}
```
Ένα άλλο παράδειγμα για τη χρήση διαφορετικού παρόχου θα μπορούσε να είναι:

```csharp
public class StorageBroker
{
    private readonly IProviderAbstraction providerAbstraction;

    public StorageBroker()
    {
        this.providerAbstraction = new ProviderAbstraction();
        
        this.providerAbstraction.Configure(provider =>
            provider.UseMariaDb(connectionString: ....));
    }
}
```

## 1.8.1 Δυνατότητα Διανομής (Distributability)
Οι βιβλιοθήκες αφηρησημότητας(Abstraction) πρέπει να επιτρέπουν σε πολλούς μηχανικούς να δημοσιεύουν τις δικές τους επεκτάσεις της βιβλιοθήκης. Η βιβλιοθήκη δεν χρειάζεται να έχει υλοποιήσεις όλων των παρόχων σε ένα δυαδικό αρχείο. Αντ' αυτού, αυτές οι βιβλιοθήκες πρέπει να παρέχουν μια διεπαφή ή ένα συμβόλαιο που όλες οι άλλες επεκτάσεις χρειάζεται να υλοποιήσουν για να υποστηρίξουν έναν συγκεκριμένο πάροχο.

Για παράδειγμα, ας υποθέσουμε ότι έχουμε τον πυρήνα της προτυποποιημένης σύμβασης Standard.Storages.Core. Μπορούμε να δημοσιεύσουμε μια βιβλιοθήκη Standard.Storages.Sql. Οποιοσδήποτε άλλος μπορεί επίσης να δημοσιεύσει το Standard.Storages.MongoDb για να υποστηρίξει την ίδια ακριβώς διεπαφή. Μια διεπαφή θα μοιάζει κάπως έτσι:"

```csharp
public interface IStorageProvider
{
    ValueTask<T> Insert(T @object);
    IQueryable<T> SelectAll();
    ...
    ...
    void Configure(Options options);
}
```
Οι δυνατότητες αυτού του συμβολαίου πρέπει να είναι το απόλυτο ελάχιστο που οποιοδήποτε πάροχος πρέπει να μπορεί να παρέχει. Ωστόσο, οι επιπλέον επιλογές στην επέκταση του παρόχου μπορεί να αποκαλύπτουν περισσότερες δυνατότητες που μπορεί να υπάρχουν ή όχι σε άλλες βιβλιοθήκες.

## 1.8.2 Εξωτερική Δυνατότητα Υποκατάστασης (Cloud-Foreign)
Οι προτυποποιημένες βιβλιοθήκες παροχής υπηρεσιών πρέπει να επιτρέπουν τις επικοινωνίες με ψευδαίσθητες τοπικές διεπαφές API. Για παράδειγμα, αν ένα σύστημα απαιτεί επικοινωνία με μια ουρά ή ένα λεωφορείο γεγονότων στον νέφος, η βιβλιοθήκη παροχής υπηρεσιών που αφαιρεί αυτήν την τεχνολογία πρέπει να επιτρέπει μια τοπική σύνδεση για αποδοχή δοκιμών και εκτελέσεις σε αεροπλάνο, όπως συζητήσαμε νωρίτερα ως Αρχή Cloud Foreign.

Η Εξωτερική Δυνατότητα Υποκατάστασης μπορεί να βασίζεται σε άλλη εξωτερική βιβλιοθήκη που υλοποιεί πρότυπα όπως το PACT για να δημιουργήσει ψευδαίσθητη ή πλαστή εξωτερική διεπαφή API που τρέχει στον τοπικό υπολογιστή ή στο δίκτυο. Εδώ έχετε ένα παράδειγμα:

```csharp
public class EventBroker
{
    private readonly IEventAbstractProvider eventAbstractProvider;

    public EventBroker(IConfiguration configuration)
    {
        this.eventAbstractProvider = 
            new EventAbstractProvider(
                configuration.Connection,
                configuration.TargetServerType);
    }
}
```
Στο παραπάνω απόσπασμα, η παράμετρος TargetServerType μπορεί να είναι είτε Remote είτε Local ως υποχρεωτικές επιλογές, αλλά οι μηχανικοί που αναπτύσσουν τη βιβλιοθήκη μπορεί να προσθέσουν και άλλες επιλογές αν το επιθυμούν.

Οι αφαιρετικές βιβλιοθήκες παροχής υπηρεσιών πρέπει να μιμούνται την ακριβή ίδια συμπεριφορά των παρόχων τους. Για παράδειγμα, σε ένα σενάριο ακρόασης ουράς, αυτές οι βιβλιοθήκες πρέπει να εκθέτουν μια διεπαφή που υποστηρίζει τα events για τα εισερχόμενα μηνύματα, ακόμα κι αν αυτά τα μηνύματα ήταν τοπικά και όχι από κάποια εξωτερική υπηρεσία όπως το νέφος.

Είναι επίσης αποδεκτό να υπάρχει η δυνατότητα υποστήριξης τοπικών δικτύων εταιρείας και δικτύων ελεγχόμενων που δεν συνδέονται με το δημόσιο διαδίκτυο σε συγκεκριμένα σενάρια με τη χρήση αυτών των ίδιων των βιβλιοθηκών.

Οι προτυποποιημένες βιβλιοθήκες αφαίρεσης παρόχων είναι υποσυστήματα που απαιτείται επίσης να έχουν τις δικές τους Μεσίτες, Υπηρεσίες και Εκθέσεις σύμφωνα με το Πρότυπο. Αυτές οι βιβλιοθήκες θα διευκολύνουν περαιτέρω την ανάπτυξη συστημάτων που είναι προσβάσιμα από τον πελάτη, με καλά καθορισμένες εξαιρέσεις για χειρισμό, προσδοκίες και απλοποιημένες τροποποιήσεις, αφού είναι ανοικτού κώδικα και συμμορφούνται με το Πρότυπο.

## 1.8.3 Από το Τοπικό στο Παγκόσμιο
Οι μηχανικοί μπορούν να αναπτύξουν τις δικές τους τοπικές βιβλιοθήκες αφαίρεσης παρόχων στην ίδια λύση, υποθέτοντας ότι δεν μπορούν να βρουν μια υπάρχουσα προσπάθεια για να υποστηρίξουν τις ανάγκες τους. Κάνοντας κάτι τέτοιο, αυτοί οι μηχανικοί ενθαρρύνονται να ανοίξουν τον κώδικα και να δημοσιεύσουν αυτό το έργο αφαίρεσης για να υποστηρίξουν άλλους μηχανικούς στην Κοινότητα The Standard που μπορεί να έχουν τις ίδιες ανάγκες.

Αυτή η πρακτική ενθαρρύνει τους μηχανικούς παντού να δημιουργούν συλλογική προσπάθεια και μοτίβο του "υποκειμένου" για να επιλύσουν ένα πρόβλημα μια φορά και να το μοιραστούν με τον υπόλοιπο Μηχανολογικό Κοινό του The Standard για περαιτέρω βελτίωση και υποστήριξη.

Οι προτυποποιημένες περιφερειακές (προς τον πελάτη) συστήματα δεν θα πρέπει πλέον να προσθέτουν στις διεπαφές τους, τις εφαρμογές επιφάνειας εργασίας ή τους δικτυακούς τους τόπους βιβλιοθήκες που δεν συμμορφώνονται με τα πρότυπα στις δικές τους διεπαφές, τις εφαρμογές επιφάνειας εργασίας ή τα άλλα συστήματα.