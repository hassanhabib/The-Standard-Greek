# 3 Εκθέτες

## 3.0 Εισαγωγή
Οι εκθέτες είναι αναλώσιμοι εξαρτήματα σε οποιοδήποτε σύστημα που έχει την αποκλειστική ευθύνη της αποκάλυψης της λειτουργικότητας της βασικής επιχειρηματικής λογικής σας, χαρτογραφώντας τις απαντήσεις της σε ένα συγκεκριμένο πρωτόκολλο. Για παράδειγμα, σε επικοινωνίες RESTful, ένας ελεγκτής API θα ήταν υπεύθυνος για την επιστροφή ενός κωδικού 200 για μια επιτυχημένη απάντηση. Το ίδιο ισχύει και για άλλα πρωτόκολλα όπως το gRPC ή το SOAP ή οποιοδήποτε άλλο πρωτόκολλο επικοινωνίας μεταξύ κατανεμημένων συστημάτων.

Τα εξαρτήματα εκθέτη είναι παρόμοια με τους μεσίτες. Είναι το τελευταίο σημείο επαφής μεταξύ της βασικής επιχειρηματικής λογικής και του εξωτερικού κόσμου. Κατασκευάζονται με την πρόθεση να αποσυνδεθούν από το τρέχον σύστημα κάποια στιγμή για να επιτρέψουν στην ίδια βασική λογική να ενσωματωθεί με σύγχρονα συστήματα, πρωτόκολλα ή διεπαφές.

<br/>
    <p align=center>
        <img src="https://user-images.githubusercontent.com/1453985/147638000-d0896f11-4117-476a-9f22-43d2b5a7d732.png">
    </p>
<br />

## 3.0.0 Σκοπός
Σε γενικές γραμμές, η κύρια ευθύνη των εξωστρεφών εξαρτημάτων είναι να επιτρέψουν σε κάποιον ή κάτι να αλληλεπιδράσει με τη λογική της επιχείρησής σας. Σε αυτήν την κύρια αρμοδιότητα, μια ακριβής χαρτογράφηση bit-by-bit σε κάθε πιθανή απάντηση από τη λογική της επιχείρησής σας πρέπει να επικοινωνηθεί προσεκτικά με τον καταναλωτή αυτής της λογικής. Λέω προσεκτικά γιατί μερικές φορές ορισμένα εσωτερικά προβλήματα στο σύστημα δεν απαιτούνται να εκτίθενται στον έξω κόσμο. Η χαρτογράφηση των απαντήσεων μπορεί συνήθως να είναι μηδενική προσπάθεια καθώς το πρωτόκολλο και η γλώσσα που επικοινωνεί η λογική του κώδικα σας είναι τα ίδια, όπως στην περίπτωση των βιβλιοθηκών που παράγονται για να εκτελούνται στο σύστημα που χρησιμοποιούν τις ίδιες τεχνολογίες ή γλώσσες προγραμματισμού.

Αλλά υπάρχουν περιστάσεις όπου το ά stateless πρωτόκολλο του εξωτερικού κόσμου δεν αντιστοιχεί απαραίτητα στην ίδια τιμή μιας απάντησης. Στην περίπτωση αυτή, γίνεται ευθύνη του εκθέτη εξαρτήματος να κάνει μια επιτυχή χαρτογράφηση και προς τα μέσα και προς τα έξω από το σύστημα. Οι ελεγκτές API είναι ένα εξαιρετικό παράδειγμα αυτού. Θα επικοινωνήσουν ένα ζήτημα 4xx όταν υπάρχει κάποια εξαίρεση επικύρωσης και θα επιστρέψουν μια αποσυναθροίστρα τιμή JSON εάν η επικοινωνία ήταν επιτυχής. Αλλά υπάρχουν και περισσότερες λεπτομέρειες γύρω από τις λεπτομέρειες του προβλήματος, τους κωδικούς σφάλματος και άλλα επίπεδα χαρτογράφησης και επικοινωνίας που θα συζητήσουμε στα προσεχή κεφάλαια αυτής της ενότητας.

### 3.0.0.0 Καθαρή χαρτογράφηση
Το πιο σημαντικό aspect των εκθέτων εξαρτημάτων είναι ότι δεν επιτρέπεται να επικοινωνούν με μεσίτες οποιουδήποτε τύπου. Και δεν επιτρέπεται να περιέχουν καμία μορφή επιχειρηματικής λογικής μέσα τους. Με επιχειρηματική λογική εννοώ καμία ακολουθία συνήθων κλήσεων, καμία επανάληψη ή επιλογή/λήψη αποφάσεων. Με τον ίδιο τρόπο όπως συμβαίνει με τους μεσίτες, συνδέουν μόνο έναν υπάρχοντα κόσμο με τον εξωτερικό κόσμο για να επιτύχουν μια ορισμένη αξία.

## 3.0.1 Τύποι εκθετών εξαρτημάτων
Τα εκθέτες εξαρτημάτων έχουν τρεις διαφορετικούς τύπους. Που είναι είτε πρωτόκολλα επικοινωνίας, είτε γραφικά περιβάλλοντα χρήστη ή απλώς μια ρουτίνα IO. Ας μιλήσουμε για αυτά σύντομα.

### 3.0.1.0 Πρωτόκολλα επικοινωνίας
Ένας εκθέτης που είναι πρωτόκολλο επικοινωνίας μπορεί να κυμαίνεται από απλά RESTful APIs, σε SOAP επικοινωνία ή gRPC. Μπορούν επίσης να είναι ένας απλός πελάτης σε μια βιβλιοθήκη όπου οι καταναλωτές θα εγκαταστήσουν απλώς τη βιβλιοθήκη στα έργα τους και θα καταναλώνουν τη λογική σας πυρήνα μέσω των API του πελάτη. Αυτά τα παραδείγματα είναι όλα του ίδιου τύπου εκθετών εξαρτημάτων.

Ο διαχωριστής εδώ είναι ότι ένα πρωτόκολλο επικοινωνίας είναι συνήθως event-based. Τ triggered από μια εισερχόμενη επικοινωνία και αντιμετωπίζεται με μια απάντηση οποιουδήποτε είδους. Τα πρωτόκολλα επικοινωνίας είναι συνήθως για ενσωμάτωση συστημάτων-προς-συστήματα, αλλά μπορούν να είναι προσιτά και κατανοητά από ανθρώπους για σκοπούς δοκιμών και αποσφαλμάτωσης.

### 3.0.1.1 Γραφικά περιβάλλοντα χρήστη
Ένας άλλος τύπος εκθετών εξαρτημάτων είναι τα γραφικά περιβάλλοντα χρήστη. Αυτό μπορεί να κυμαίνεται από ιστοσελίδες, κινητές ή επιτραπέζιες εφαρμογές, συμπεριλαμβανομένων απλών γραμμών εντολών. Απευθύνονται κυρίως σε τελικούς χρήστες για επικοινωνία, αλλά μπορούν να αυτοματοποιηθούν από άλλα συστήματα. Ιδιαίτερα με γραφικά περιβάλλοντα γραμμών εντολών. Στις μέρες μας, τα γραφικά περιβάλλοντα χρήστη μπορούν επίσης να περιλαμβάνουν εικονικές και επαυξημένες πραγματικότητες, metaverses και οποιονδήποτε άλλο τύπο λογισμικού.

### 3.0.1.2 Ε/Σ Εξαρτήματα
Ορισμένοι εκθέτες εξαρτημάτων δεν είναι απαραίτητα ένα σύστημα που διασυνδέεται με άλλο σύστημα. Ούτε προορίζονται να επικοινωνούν με ανθρώπους. Είναι δαιμόνια ή εξαρτήματα που βασίζονται σε IO που κάνουν κάτι στο παρασκήνιο χωρίς σκανδάλη. Συνήθως αυτά τα εξαρτήματα είναι χρονοβόρα και μπορούν να αξιοποιήσουν υπάρχοντα πρωτόκολλα ή απλώς να διασυνδεθούν απευθείας με τη λογική πυρήνα της επιχείρησης, τα οποία είναι και οι δύο βιώσιμες επιλογές.

## 3.0.2 Μοναδικό Σημείο Επαφής
Τα εξωστρεφή εξαρτήματα επιτρέπεται να επικοινωνούν μόνο με μία και μόνο υπηρεσία. Η ενσωμάτωση με πολλές υπηρεσίες θα μετατρέψει έναν εκθέτη εξαρτήματος είτε σε υπηρεσίες ορχήστρας είτε σε υπηρεσίες συσσώρευσης, οι οποίες και οι δύο δεν επιτρέπεται να υπάρχουν ως βασική λογική σε αυτόν τον τομέα έκθεσης.

Ο κανόνας του μοναδικού σημείου επαφής διασφαλίζει επίσης την ευκολία απόρριψης του ίδιου του εκθέτη εξαρτήματος. Εξασφαλίζει ότι η ενσωμάτωση είναι αρκετά απλή και μεμονωμένη σκοπό με ελεγχόμενες εξαρτήσεις (μόνο μία) ώστε να μπορεί να επανασυνδεθεί σε σχεδόν οποιοδήποτε πρωτόκολλο ανά πάσα στιγμή με το ελάχιστο δυνατό κόστος.

## 3.0.3 Παραδείγματα
Ας πάρουμε τους ελεγκτές API ως παράδειγμα για έναν πραγματικό εκθέτη εξαρτημάτων σε οποιοδήποτε σύστημα.

Οι ελεγκτές API είναι ένα είδος εκθέτη εξαρτημάτων που είναι υπεύθυνοι για την επεξεργασία των αιτημάτων από τους χρήστες και την επιστροφή των κατάλληλων απαντήσεων. Συνήθως βασίζονται σε κάποιο υπάρχον πρωτόκολλο, όπως το RESTful ή το SOAP.

Οι ελεγκτές API μπορούν να υλοποιηθούν σε διάφορες γλώσσες προγραμματισμού, όπως το Java, το Python και το C#. Είναι συνήθως εύκολο να αναπτύξουν και να διατηρήσουν, καθώς ο σκοπός τους είναι αρκετά απλός.

Εκτός από τους ελεγκτές API, υπάρχουν και άλλοι τύποι εκθετών εξαρτημάτων, όπως τα γραφικά περιβάλλοντα χρήστη (GUI) και οι διακομιστές WebSocket. Όλοι αυτοί οι τύποι εκθετών εξαρτημάτων έχουν τον κοινό σκοπό να διασυνδέσουν την λογική πυρήνα της επιχείρησης με τον εξωτερικό κόσμο.

```csharp

[HttpPost]
public async ValueTask<ActionResult<Student>> PostStudentAsync(Student student)
{
    try
    {
        Student registeredStudent =
            await this.studentService.RegisterStudentAsync(student);

        return Created(registeredStudent);
    }
    catch (StudentValidationException studentValidationException)
        when (studentValidationException.InnerException is AlreadyExistsStudentException)
    {
        return Conflict(studentValidationException.InnerException);
    }
    catch (StudentValidationException studentValidationException)
    {
        return BadRequest(studentValidationException.InnerException);
    }
    catch (StudentDependencyException studentDependencyException)
    {
        return InternalServerError(studentDependencyException);
    }
    catch (StudentServiceException studentServiceException)
    {
        return InternalServerError(studentServiceException);
    }
}

```
Ο παραπάνω κώδικας απόσπασμα είναι για μια μέθοδο API που `POST` ένα μοντέλο φοιτητή στη βασική επιχειρηματική λογική ενός εκπαιδευτικού συστήματος (OtripleS). Σε μια τεχνολογία όπως το ASP.NET, οι ελεγκτές αναλαμβάνουν τη διαχείριση της χαρτογράφησης των εισερχόμενων αιτημάτων JSON στο μοντέλο `Student` ώστε ο ελεγκτής να μπορεί να αξιοποιήσει αυτό το μοντέλο με ένα ολοκληρωμένο σύστημα.

Ωστόσο, θα δείτε επίσης ότι ο κώδικας του ελεγκτή προσπαθεί να χαρτογραφήσει κάθε δυνατή κατηγορική εξαίρεση στο αντίστοιχο πρωτόκολλο `REST`. Αυτό είναι απλώς ένα απλό απόσπασμα για να δείξει πώς μπορεί να μοιάζει ένας εκθέτης εξαρτήματος. Αλλά θα μιλήσουμε για τους κανόνες και τις συνθήκες για ελεγκτές στο επόμενο κεφάλαιο στο The Standard.

## 3.0.4 Περίληψη
Συνοψίζοντας, τα εξωστρεφή εξαρτήματα είναι πολύ λεπτό στρώμα που δεν περιέχει καμία νοημοσύνη ή λογική. δεν προορίζεται να ορχήστρει, ή να καλέσει πολλαπλές υπηρεσίες βασικής επιχειρηματικής λογικής. Και επικεντρώνεται μόνο στην ασύμμετρη χαρτογράφηση της επικοινωνίας μεταξύ ενός συστήματος και άλλου.
